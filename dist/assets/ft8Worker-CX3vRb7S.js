(function(){"use strict";var fe=(function(){var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(e){e=e||{};var e=typeof e<"u"?e:{},d,f;e.ready=new Promise(function(n,t){d=n,f=t});var h={},u;for(u in e)e.hasOwnProperty(u)&&(h[u]=e[u]);var K=function(n,t){throw t},X=typeof window=="object",W=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var m="";function pe(n){return e.locateFile?e.locateFile(n,m):m+n}var j;(X||W)&&(W?m=self.location.href:typeof document<"u"&&document.currentScript&&(m=document.currentScript.src),i&&(m=i),m.indexOf("blob:")!==0?m=m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):m="",W&&(j=function(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var ye=e.print||console.log.bind(console),A=e.printErr||console.warn.bind(console);for(u in h)h.hasOwnProperty(u)&&(e[u]=h[u]);h=null,e.arguments&&e.arguments,e.thisProgram&&e.thisProgram,e.quit&&(K=e.quit);var b;e.wasmBinary&&(b=e.wasmBinary),e.noExitRuntime,typeof WebAssembly!="object"&&B("no native wasm support detected");var $,J=!1,Q=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Z(n,t,o){for(var R=t+o,c=t;n[c]&&!(c>=R);)++c;if(c-t>16&&n.subarray&&Q)return Q.decode(n.subarray(t,c));for(var p="";t<c;){var r=n[t++];if(!(r&128)){p+=String.fromCharCode(r);continue}var s=n[t++]&63;if((r&224)==192){p+=String.fromCharCode((r&31)<<6|s);continue}var y=n[t++]&63;if((r&240)==224?r=(r&15)<<12|s<<6|y:r=(r&7)<<18|s<<12|y<<6|n[t++]&63,r<65536)p+=String.fromCharCode(r);else{var se=r-65536;p+=String.fromCharCode(55296|se>>10,56320|se&1023)}}return p}function he(n,t){return n?Z(E,n,t):""}var E,I;function ge(n){e.HEAP8=new Int8Array(n),e.HEAP16=new Int16Array(n),e.HEAP32=I=new Int32Array(n),e.HEAPU8=E=new Uint8Array(n),e.HEAPU16=new Uint16Array(n),e.HEAPU32=new Uint32Array(n),e.HEAPF32=new Float32Array(n),e.HEAPF64=new Float64Array(n)}e.INITIAL_MEMORY;var ee,ne=[],te=[],re=[];function ve(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Re(e.preRun.shift());z(ne)}function we(){z(te)}function _e(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Se(e.postRun.shift());z(re)}function Re(n){ne.unshift(n)}function Ae(n){te.unshift(n)}function Se(n){re.unshift(n)}var _=0,T=null;function be(n){_++,e.monitorRunDependencies&&e.monitorRunDependencies(_)}function Ee(n){if(_--,e.monitorRunDependencies&&e.monitorRunDependencies(_),_==0&&T){var t=T;T=null,t()}}e.preloadedImages={},e.preloadedAudios={};function B(n){e.onAbort&&e.onAbort(n),n="Aborted("+n+")",A(n),J=!0,n+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(n);throw f(t),t}var Ie="data:application/octet-stream;base64,";function ie(n){return n.startsWith(Ie)}var l;l="decode_ft8.wasm",ie(l)||(l=pe(l));function oe(n){try{if(n==l&&b)return new Uint8Array(b);if(j)return j(n);throw"both async and sync fetching of the wasm failed"}catch(t){B(t)}}function Te(){return!b&&(X||W)&&typeof fetch=="function"?fetch(l,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+l+"'";return n.arrayBuffer()}).catch(function(){return oe(l)}):Promise.resolve().then(function(){return oe(l)})}function Pe(){var n={a:Be};function t(r,s){var y=r.exports;e.asm=y,$=e.asm.g,ge($.buffer),ee=e.asm.k,Ae(e.asm.h),Ee()}be();function o(r){t(r.instance)}function R(r){return Te().then(function(s){return WebAssembly.instantiate(s,n)}).then(function(s){return s}).then(r,function(s){A("failed to asynchronously prepare wasm: "+s),B(s)})}function c(){return!b&&typeof WebAssembly.instantiateStreaming=="function"&&!ie(l)&&typeof fetch=="function"?fetch(l,{credentials:"same-origin"}).then(function(r){var s=WebAssembly.instantiateStreaming(r,n);return s.then(o,function(y){return A("wasm streaming compile failed: "+y),A("falling back to ArrayBuffer instantiation"),R(o)})}):R(o)}if(e.instantiateWasm)try{var p=e.instantiateWasm(n,t);return p}catch(r){return A("Module.instantiateWasm callback failed with error: "+r),!1}return c().catch(f),{}}function z(n){for(;n.length>0;){var t=n.shift();if(typeof t=="function"){t(e);continue}var o=t.func;typeof o=="number"?t.arg===void 0?ae(o)():ae(o)(t.arg):o(t.arg===void 0?null:t.arg)}}var N=[];function ae(n){var t=N[n];return t||(n>=N.length&&(N.length=n+1),N[n]=t=ee.get(n)),t}function Me(n,t,o){E.copyWithin(n,t,t+o)}function Fe(n){B("OOM")}function Oe(n){E.length,Fe()}function Ue(n){He(n)}var H={mappings:{},buffers:[null,[],[]],printChar:function(n,t){var o=H.buffers[n];t===0||t===10?((n===1?ye:A)(Z(o,0)),o.length=0):o.push(t)},varargs:void 0,get:function(){H.varargs+=4;var n=I[H.varargs-4>>2];return n},getStr:function(n){var t=he(n);return t},get64:function(n,t){return n}};function Ce(n){return 0}function De(n,t,o,R,c){}function We(n,t,o,R){for(var c=0,p=0;p<o;p++){var r=I[t>>2],s=I[t+4>>2];t+=8;for(var y=0;y<s;y++)H.printChar(n,E[r+y]);c+=s}return I[R>>2]=c,0}var Be={c:Me,a:Oe,f:Ue,d:Ce,b:De,e:We};Pe(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.h).apply(null,arguments)},e._malloc=function(){return(e._malloc=e.asm.i).apply(null,arguments)},e._decode_ft8=function(){return(e._decode_ft8=e.asm.j).apply(null,arguments)};var x;function Ne(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}T=function n(){x||G(),x||(T=n)};function G(n){if(_>0||(ve(),_>0))return;function t(){x||(x=!0,e.calledRun=!0,!J&&(we(),d(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),_e()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),t()},1)):t()}e.run=G;function He(n,t){xe(n)}function xe(n){K(n,new Ne(n))}if(e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return G(),e.ready})})(),ue="/assets/decode_ft8-BmAsUujb.wasm";const V=12e3,S=15,P=V*S,ce=120;let M=null,Y=48e3,L=0,g=null,v=0,F=!1,q=!1,O=0,U=0,w=0,C=1;function D(i){self.postMessage(i)}function k(i){D({type:"log",text:i})}function le(){if(q||F)return;q=!0;const i=()=>{if(F)return;try{M?._decode_ft8(0,0,L,1)}catch(u){D({type:"error",message:u?.message??String(u)})}const d=v-P;d>0&&g?(g.set(g.slice(P,v),0),v=Math.min(d,ce)):v=Math.min(v,P);const f=Date.now()+O,h=S*1e3-f%(S*1e3);setTimeout(i,h)},a=Date.now()+O,e=S*1e3-a%(S*1e3);setTimeout(i,e)}async function de(i,a){F=!1,q=!1,v=0,Y=i,O=Number.isFinite(a)?Math.round(a):0,U=0,w=0,C=Y/V,M=await fe({print:f=>k(f),printErr:f=>k(f),locateFile:f=>f.endsWith(".wasm")?ue:f});const d=P*2;L=M._malloc(d*4),g=new Float32Array(M.HEAPU8.buffer,L,d),g.fill(0),D({type:"ready"}),le()}function me(i){if(!g||!Number.isFinite(C)||C<=0)return;const a=i.length+1;for(;w+1<a;){const e=Math.floor(w),d=w-e,f=e===0?U:i[e-1],h=e===0?i[0]:i[e],u=f+(h-f)*d;if(v<g.length)g[v++]=u;else break;w+=C}w-=i.length,w<0&&(w=0),U=i.length>0?i[i.length-1]:U}self.onmessage=i=>{const a=i.data;if(a.type==="stop"){F=!0;return}if(a.type==="timeOffset"){O=Number.isFinite(a.offsetMs)?Math.round(a.offsetMs):0;return}if(a.type==="init"){de(a.inputSampleRate,a.timeOffsetMs??0).catch(e=>{D({type:"error",message:e?.message??String(e)})});return}a.type==="pcm"&&me(a.pcm)}})();
